import React, {useContext, useEffect, useState} from 'react';
import classes from "./ModalRating.module.css";
import RatingItem from "../../IU/List/RatingList/RatingItem/RatingItem";
import Service from "../../../Service/Service";
import {AuthContext} from "../../../context";

const ModalRating = (props) => {

    const {user} = useContext(AuthContext)
    const [modal, setModal] = useState(false);
    const [userData, setUserData] = useState({
        username: user.name, sumScore: 0, place: 0
    });

    // const setUser = (username, sumScore, place) => {
    //     setUserData({username, sumScore, place})
    // }


    // const zaglushka = "https://st2.depositphotos.com/5266903/8766/v/450/depositphotos_87660356-stock-illustration-healh-care-emblem-icon.jpg";
    const [rating, setRating] = useState([
        {username: "", sumScore: 0, place: 1},
    ])

    const iteratingUsers = (response) => {
        console.log(user)
        response.map(rat => {

        if (rat.userId == user.id) {
            console.log(userData)
            setUserData(rat)
        }
        }
    )


    }


    useEffect(() => {
        const getRating = async () => {
            const response = await Service.getLeaderBoard(props.id);
            iteratingUsers(response);

            let rat = [];

            if (rating.length==11){

                for (let i =0; i<10;i++){
                    rat.push(rating[i])
                }
            }else rat = response
            setRating(rat)


        }
        getRating();



    }, [modal])

    return (
        <div className={classes.modalRating}>
            {/*<input onClick={()=>setModal(true)} type="button" value="Рейтинг"/>*/}
            <svg onClick={() => setModal(true)} width="48" height="48" viewBox="0 0 48 48" fill="none"
                 xmlns="http://www.w3.org/2000/svg">
                <circle cx="24" cy="24" r="23.5" fill="white" stroke="#F2D380"/>
                <path
                    d="M35.6723 26.088L35.1923 26.408L34.9363 26.888L34.6803 27.304L34.4883 27.688L34.3283 28.072L34.0723 28.488L33.8803 28.872L33.6243 29.256L33.4323 29.608L33.1443 29.928L32.9203 30.28L32.2803 30.824L31.8003 30.952L31.1923 31.048L30.4243 30.856L29.8483 30.408L29.2083 29.576L28.9203 29.256L28.7283 28.872L28.5683 28.488L28.3763 28.168L28.1203 27.752L27.8003 26.984L27.6403 26.632L27.0963 25.48L26.9363 25.096L26.8083 24.744L26.5843 24.328L26.4243 24.008L26.2963 23.656L26.2323 23.176L26.4883 22.888L26.8723 22.76L27.3203 22.632L27.7683 22.44L28.0883 22.248L28.5043 22.056L29.1763 21.576L29.5283 21.32L29.7843 21L30.1363 20.712L30.3603 20.424L30.7763 19.88L31.0643 19.336L31.1923 18.92L31.3203 18.536L31.4803 18.152L31.6083 17.736V17.288L31.6723 16.648L31.6083 16.008L31.5763 15.624L31.4803 15.208L31.3523 14.824L31.2563 14.376L31.1283 14.056L30.9363 13.672L30.6163 13.288L30.1683 12.648L29.8483 12.36L29.2083 11.816L28.8563 11.56L28.4723 11.4L27.5123 10.92L26.9043 10.728L26.4563 10.632L26.0083 10.504L25.2723 10.44L24.2483 10.344H23.5763L23.0642 10.408H22.6803L22.3283 10.44L21.8163 10.568L21.4323 10.632L21.0163 10.696L19.7683 11.112L19.0963 11.464L18.7763 11.688L18.3283 11.912L18.0403 12.2L17.6243 12.424L17.3363 12.648L17.1443 13L16.7923 13.288L16.5043 13.64L16.2803 13.96L16.1203 14.344L15.8643 14.696L15.7043 15.048L15.4483 15.432L15.2883 16.264L15.1283 16.68V17.128L15.0643 17.512V17.896L15.0003 18.344L15.0963 18.952L15.3843 19.464L15.8003 19.528L16.3123 19.496L16.6003 19.304L16.8563 18.824L16.9203 18.216L16.9523 17.384L17.0483 17L17.1123 16.552L17.2083 16.232L17.5923 15.432L17.7523 15.08L18.0083 14.728L18.2963 14.44L18.5843 14.12L19.1923 13.608L19.5123 13.384L20.1843 12.968L20.6003 12.776L21.0163 12.68L21.3683 12.584L21.7843 12.456L22.1683 12.36L22.6163 12.296L23.0323 12.232L24.0563 12.264H24.4403L25.1123 12.296L25.5603 12.392L25.9443 12.488L26.2963 12.584L26.7443 12.744L27.2563 13.032L27.8003 13.384L28.4083 13.864L28.7283 14.216L28.9203 14.536L29.1763 14.856L29.3683 15.24L29.5923 16.648L29.6243 17.288L29.5603 17.672L29.4643 18.024L29.3683 18.472L29.0803 18.856L28.8883 19.208L28.7603 19.528L28.1523 20.136L27.8643 20.36L27.6083 20.616L26.8723 21.032L26.4883 21.192L26.0723 21.352L24.7923 21.608L24.4723 21.64L23.6403 21.704L22.8083 21.736H22.3283L21.9123 21.512L21.7523 21.032V20.648L21.7843 20.232V19.784L21.8802 19.368L21.8483 18.568L21.8802 18.152L21.7843 17.704L21.7523 17.288V16.936L21.5923 16.488L21.3363 15.272L21.1123 14.76L20.6643 14.44L20.3123 14.472L19.9603 14.6L19.6083 14.856L19.5763 15.368L19.6403 15.944L19.7683 16.328L19.8643 16.712V17.128L20.0563 17.992V18.408L20.0243 18.792L20.0563 19.176L20.0243 19.592L20.0563 20.008L19.9603 20.456L19.9283 20.84L19.7363 21.288L19.2883 21.672L19.0643 21.928L18.9363 22.312V22.696L19.2243 23.016L19.5763 23.464L19.6403 23.944L19.5123 24.744V25.16L19.3843 25.608L19.3203 26.024V26.44L19.2883 26.92L19.0963 27.752L19.0323 28.136V28.584L18.9363 29L18.8083 29.384V29.832L18.7123 30.216L18.6483 30.664L18.6803 31.112L18.6163 31.496L18.6483 31.944L18.6803 32.52L18.9043 32.936L19.2563 33.064H19.7043L20.1203 32.968L20.3763 32.52L20.5043 31.464L20.5363 30.632L20.6323 30.216L20.7283 29.384L20.6963 29L20.8243 28.552L20.8883 28.104L20.9843 27.688L21.0483 26.92L21.1123 26.472L21.1763 26.056L21.2723 25.64L21.3363 25.256L21.4643 24.36V23.976L21.8163 23.592L22.2963 23.336L22.6803 23.368L23.1603 23.4L23.7363 23.656L24.1843 24.008L24.4403 24.36L24.6323 24.744L24.8563 25.128L25.0163 25.512L25.2083 25.864L25.3363 26.28L25.7203 27.048L25.8483 27.4L26.4243 28.552L26.5843 28.936L26.8083 29.32L27.3523 30.376L28.1523 31.432L28.7283 32.072L29.0803 32.328L29.4003 32.552L29.7523 32.712L30.1363 32.872L30.7443 32.968L31.3523 32.904L31.8003 32.84L32.1203 32.68L32.5043 32.52L32.8883 32.264L33.1763 32.04L33.5923 31.816L33.8803 31.496L34.1683 31.208L34.3603 30.856L34.6483 30.536L35.1603 29.832L35.5763 29.064L35.6723 28.744L35.8963 28.328L36.1203 27.976L36.4723 27.016L36.4083 26.44L36.0243 26.152L35.6723 26.088ZM23.8003 11.112L23.6083 11.048L23.6723 10.856L23.8323 10.92L23.8003 11.112ZM24.8243 10.888V11.048H24.6643L24.6323 10.92L24.8243 10.888ZM25.6883 11.08L25.5923 11.048V10.888L25.7203 10.92L25.6883 11.08ZM22.3283 11.528L22.0723 11.464L21.9123 11.368L21.7523 11.304L21.5603 11.112L21.6883 10.952L21.9443 11.048L22.1042 11.144L22.2323 11.24L22.3923 11.368L22.3283 11.528ZM21.2403 11.496V11.336L21.3683 11.368L21.3363 11.496H21.2403ZM23.1603 11.56L23.1283 11.368L23.2883 11.336L23.3203 11.528L23.1603 11.56ZM24.3123 11.496L24.1523 11.464L24.1843 11.336H24.3443L24.3123 11.496ZM26.2643 11.56L26.1043 11.592L26.0723 11.432L26.2323 11.4L26.2643 11.56ZM27.1283 11.4H27.2563L27.2243 11.528L27.1283 11.496V11.4ZM20.3763 11.592L20.2803 11.56V11.464L20.3763 11.496V11.592ZM20.9203 11.976H20.7283L20.6963 11.784L20.8883 11.752L20.9203 11.976ZM19.8323 12.008L19.6723 11.944L19.7363 11.784L19.8963 11.88L19.8323 12.008ZM25.6563 11.912L25.6883 11.784L25.7843 11.816V11.912H25.6563ZM26.6163 11.88L26.7443 11.848V12.008H26.6163V11.88ZM27.7043 11.976H27.6083V11.848H27.7043V11.976ZM21.7843 11.88V11.976L21.7203 12.008V11.912L21.7843 11.88ZM19.3843 12.296V12.456H19.2243V12.328L19.3843 12.296ZM27.2243 12.456H27.0643L27.0963 12.328L27.2563 12.36L27.2243 12.456ZM28.1843 12.552L27.9603 12.52L27.9923 12.36H28.2163L28.1843 12.552ZM29.2083 12.488L29.1123 12.456L29.0803 12.36L29.2083 12.392V12.488ZM28.7283 12.84L28.6963 13.032H28.4723L28.5043 12.84H28.7283ZM29.6562 13H29.4963L29.5283 12.84H29.6562V13ZM17.7523 13.096V12.904H17.9443L17.9123 13.064L17.7523 13.096ZM29.2083 13.512L29.0163 13.48V13.256H29.2403L29.2083 13.512ZM18.4563 13.32L18.4243 13.48H18.2643L18.3283 13.288L18.4563 13.32ZM30.1683 13.288L30.1363 13.416H30.0083L30.0403 13.288H30.1683ZM17.3043 13.48V13.352H17.4323V13.48H17.3043ZM29.7523 13.992H29.4963L29.5283 13.768L29.7523 13.8V13.992ZM30.5843 13.992H30.4563V13.832H30.6163L30.5843 13.992ZM30.2003 14.216L30.2323 14.44L30.0083 14.472L29.9763 14.248L30.2003 14.216ZM17.3363 14.504L17.2083 14.44L17.2403 14.28L17.3683 14.344L17.3363 14.504ZM30.0723 15.432L30.0083 15.304L30.2963 15.016L30.3923 14.888L30.5522 14.728H30.7123L30.6803 14.92L30.4883 15.176L30.3603 15.272L30.2323 15.4L30.0723 15.432ZM16.8883 14.824L16.8563 14.92H16.7923L16.8243 14.792L16.8883 14.824ZM16.5043 15.432H16.2803L16.3443 15.208L16.5043 15.24V15.432ZM31.0963 15.464L30.9683 15.432L31.0003 15.336H31.1283L31.0963 15.464ZM20.9523 16.008L20.7283 15.976V15.752L20.9203 15.816L20.9523 16.008ZM30.6163 16.008L30.5203 16.136L30.2963 16.328L30.2003 16.456L30.0083 16.264L30.1042 16.2L30.2963 15.976L30.3603 15.88L30.5843 15.752L30.6163 16.008ZM16.4403 16.264V16.392L16.3123 16.328V16.2L16.4403 16.264ZM20.4083 16.392L20.2163 16.36L20.2803 16.2H20.4403L20.4083 16.392ZM31.0003 16.264L31.0963 16.296L31.0643 16.392L30.9683 16.36L31.0003 16.264ZM15.9923 16.68V16.84H15.8003L15.8323 16.68H15.9923ZM20.8883 16.872L20.7283 16.904V16.744L20.8883 16.712V16.872ZM30.5203 16.872L30.4883 16.712H30.7123V16.904L30.5203 16.872ZM16.4083 17.352L16.2803 17.32V17.16L16.4083 17.192V17.352ZM30.1363 17.224L30.1683 17.32L30.0723 17.352L30.0083 17.256L30.1363 17.224ZM15.9283 17.832L15.7682 17.8L15.8003 17.672L15.9283 17.704V17.832ZM20.8563 18.024L20.7283 18.12L20.6003 18.184L20.4403 18.216L20.4723 18.088L20.5363 17.96L20.6643 17.736L20.8883 17.8L20.8563 18.024ZM30.6163 17.832H30.5203V17.768H30.6163V17.832ZM15.8963 18.664L15.9923 18.44L16.0563 18.312L16.1523 18.184L16.3763 18.024L16.4083 18.248L16.3123 18.376L16.0883 18.6L15.8963 18.664ZM30.2323 18.152L30.2003 18.312L30.0403 18.28L30.0723 18.12L30.2323 18.152ZM15.5763 18.216L15.6403 18.376L15.4803 18.344L15.4163 18.216H15.5763ZM21.1763 18.44L21.1443 18.248L21.3363 18.216L21.3683 18.44H21.1763ZM20.8883 18.856H20.7283V18.696H20.8883V18.856ZM30.6483 18.728L30.6163 18.856L30.5203 18.888V18.76L30.6483 18.728ZM21.5283 18.92V18.952L21.4643 19.176L21.4323 19.336L21.2403 19.368L21.2723 19.176L21.5283 18.92ZM30.1363 19.304L30.0403 19.272L30.1042 19.176L30.2003 19.208L30.1363 19.304ZM20.9523 19.848L20.7283 19.88L20.6963 19.656H20.9203L20.9523 19.848ZM29.6243 19.72L29.6562 19.816L29.5603 19.848L29.5283 19.752L29.6243 19.72ZM21.3043 20.328L21.2403 20.36L21.2083 20.296L21.2723 20.264L21.3043 20.328ZM20.6323 20.872V20.616H20.8563L20.8883 20.872H20.6323ZM21.1763 21.352L21.1443 21.096H21.3683V21.352H21.1763ZM20.3763 21.32L20.2163 21.256L20.2483 21.128L20.4083 21.16L20.3763 21.32ZM28.1843 21.256L28.0563 21.288V21.128H28.1843V21.256ZM20.6323 21.768L20.6643 21.544H20.8883V21.8L20.6323 21.768ZM21.7843 21.832L21.6243 21.8L21.5923 21.64H21.7523L21.7843 21.832ZM19.9283 21.768L19.8323 21.8L19.8003 21.672H19.8963L19.9283 21.768ZM25.7523 21.832V21.896L25.6883 21.864V21.8L25.7523 21.832ZM20.3763 22.312L20.1203 22.28L20.1843 21.992L20.4403 22.056L20.3763 22.312ZM21.2083 22.344V22.088L21.4003 22.024L21.4323 22.28L21.2083 22.344ZM25.3363 22.44L25.2083 22.344L25.0803 22.152L25.1763 22.088L25.3683 22.184L25.4643 22.344L25.6243 22.504L25.7523 22.568L25.8163 22.76H25.6243L25.5283 22.6L25.3363 22.44ZM26.1043 22.28L26.0723 22.088L26.2323 22.152L26.2643 22.344L26.1043 22.28ZM27.2243 22.184H27.1283L27.1603 22.088L27.2243 22.12V22.184ZM22.1683 22.344L22.1363 22.152L22.3283 22.12L22.3603 22.312L22.1683 22.344ZM24.0563 22.344L24.1203 22.152L24.2483 22.12V22.28L24.0883 22.376L23.9923 22.504L23.9283 22.664L23.6723 22.792L23.5443 22.6L23.7683 22.472L23.8963 22.44L24.0563 22.344ZM23.2243 22.44L23.1283 22.536L23.0003 22.632L22.9043 22.728L22.6803 22.792L22.6483 22.664L22.8083 22.504L22.9363 22.44L23.0323 22.312L23.2243 22.184L23.3203 22.248L23.2243 22.44ZM20.9203 22.44L21.0163 22.536L20.9843 22.792L20.8883 22.856L20.6323 22.792V22.472L20.9203 22.44ZM19.9283 22.728L19.7363 22.76L19.7683 22.504L19.9603 22.472L19.9283 22.728ZM24.7923 22.792L24.6003 22.76V22.536L24.7923 22.568V22.792ZM22.2323 23.24L21.9763 23.08L21.8163 22.984L21.5923 22.792L21.6883 22.6L22.0083 22.76L22.1363 22.856L22.2323 22.952L22.3283 23.112L22.2323 23.24ZM21.3363 23.272L21.3043 23.432L21.0803 23.656L20.9843 23.784L20.7603 23.88L20.6003 23.688V23.56L20.7923 23.368L20.9523 23.24L21.0483 23.144L21.1443 22.92L21.3683 23.016L21.3363 23.272ZM24.3443 23.272L24.0883 23.24V23.016L24.3443 23.048V23.272ZM25.3363 23.336H25.0163V23.016L25.3363 23.048V23.336ZM20.4403 23.272H20.1843L20.1523 23.048H20.4083L20.4403 23.272ZM24.7603 23.528V23.688H24.6003V23.528H24.7603ZM25.8483 23.752L25.6243 23.784L25.5283 23.528H25.7523L25.8483 23.752ZM25.3363 23.88L25.4003 24.104L25.4323 24.264L25.6243 24.456L25.8483 24.648L25.6883 24.872L25.4643 24.712L25.2083 24.52L25.0163 24.264V24.072L25.0803 23.944L25.3363 23.88ZM26.1363 24.104L26.0723 24.136L26.0403 24.04L26.1043 24.008L26.1363 24.104ZM20.4083 24.04L20.3763 24.296L20.1523 24.264L20.1843 24.04H20.4083ZM20.8563 24.712L20.6963 24.68L20.7603 24.488L20.9203 24.52L20.8563 24.712ZM20.3763 25.256L20.1843 25.288L20.1523 25.064H20.3443L20.3763 25.256ZM26.1683 25.224H26.0403V25.096L26.1683 25.064V25.224ZM26.6803 25.672H26.5523V25.544H26.6803V25.672ZM26.1043 25.928L26.2963 25.96V26.184H26.1043V25.928ZM20.3443 26.248H20.1523L20.1843 26.056L20.3443 26.088V26.248ZM20.6323 26.536V26.408L20.7283 26.44V26.536H20.6323ZM26.5523 26.664L26.5843 26.504H26.7443L26.7123 26.696L26.5523 26.664ZM20.4083 27.016L20.3763 27.176L20.1843 27.144L20.2163 26.952L20.4083 27.016ZM26.2963 26.984L26.2643 27.08H26.1043L26.1683 26.952L26.2963 26.984ZM27.6403 27.56L27.5443 27.592L27.2243 27.4L27.1283 27.304L27.0963 27.08L27.2883 27.144L27.4803 27.4L27.6403 27.56ZM26.7763 27.56H26.5843V27.4H26.7763V27.56ZM19.8963 27.464L19.8643 27.592L19.7043 27.56L19.7363 27.464H19.8963ZM27.2563 28.136H27.0323L27.0003 27.912L27.1923 27.944L27.2563 28.136ZM20.2803 28.104L20.1523 28.072L20.1843 27.976H20.2803V28.104ZM27.7043 28.616L27.5443 28.584L27.5763 28.456L27.7043 28.424V28.616ZM19.7043 28.616L19.7363 28.456H19.8963L19.8643 28.616H19.7043ZM27.2883 29.032L27.1923 29L27.2243 28.904L27.3203 28.936L27.2883 29.032ZM28.1843 29.032V29.16L28.0563 29.064L28.1843 29.032ZM19.7043 29.608L19.7363 29.352L19.9283 29.416V29.64L19.7043 29.608ZM27.7043 29.448L27.6723 29.576L27.6083 29.512L27.6403 29.416L27.7043 29.448ZM19.3843 29.928L19.3523 30.056L19.2563 29.992L19.2883 29.896L19.3843 29.928ZM28.2163 30.024L28.0883 30.056L28.0563 29.896H28.2163V30.024ZM19.6083 30.536L19.6723 30.376L19.8643 30.344V30.536L19.7363 30.632L19.5123 30.856L19.3523 31.08L19.1923 30.92L19.4483 30.76L19.6083 30.536ZM28.6643 30.376V30.504H28.5683L28.5363 30.408L28.6643 30.376ZM29.2083 31.144H28.9843V30.888H29.2083V31.144ZM29.5603 31.688L29.4643 31.464L29.6562 31.272L29.7843 31.24L29.9443 31.08L30.0723 31.208L29.9443 31.432L29.8803 31.528L29.7843 31.688H29.5603ZM19.7363 31.336L19.8323 31.368L19.8643 31.464H19.7363V31.336ZM30.6803 31.688H30.4563V31.496L30.6803 31.464V31.688ZM30.2003 31.848L30.1683 32.04L30.0083 32.008V31.848H30.2003ZM31.1283 32.008L30.9683 32.04L30.9363 31.88L31.0963 31.848L31.1283 32.008ZM32.0243 32.072V31.912H32.1523L32.1203 32.072H32.0243ZM30.4883 32.488V32.328H30.6483V32.488H30.4883Z"
                    fill="#F2D380"/>
            </svg>
            <div onClick={() => setModal(false)} className={modal ? classes.smoky : classes.noSmoky}>

            </div>
            <div className={modal ? classes.modal : classes.noModal}>
                <div className={classes.close}>
                    <svg onClick={() => setModal(false)} width="37" height="37" viewBox="0 0 37 37" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <circle cx="18.5" cy="18.5" r="18" fill="white" stroke="#76BA7D"/>
                        <rect width="25.3524" height="4.62014" rx="2"
                              transform="matrix(-0.744576 0.667538 -0.756474 -0.654024 29.9639 10.907)" fill="#76BA7D"/>
                        <rect width="25.4139" height="4.60895" rx="2"
                              transform="matrix(0.757107 0.653291 -0.743926 0.668262 10.707 8.82556)" fill="#76BA7D"/>
                    </svg>
                </div>
                <div className={classes.content}>
                    <div className={classes.title}> Рейтинг</div>
                </div>
                <div className={classes.rating}>
                    {
                        rating.map(rat =>
                            <RatingItem nik={rat.username} img="" count={rat.sumScore} color="green" index={rat.place}
                                        key={rat.place}/>
                        )
                    }

                </div>
                <div className={classes.footer}>
                    <RatingItem nik={userData.username} count={userData.sumScore}
                                color="green" index={userData.place}/>
                </div>


            </div>
        </div>
    );
};

export default ModalRating;